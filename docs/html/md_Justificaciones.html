<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Proyecto Chatbot Grupo 21: Justificaciones:</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Proyecto Chatbot Grupo 21
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_Justificaciones.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Justificaciones: </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr  />
<h1><a class="anchor" id="autotoc_md1"></a>
Utilización de patrones:</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Patrones y principios utilizados:</h2>
<ul>
<li><b>Chain of responsibility</b>: Utilizamos este patrón para todos los Handlers dentro de la carpeta 'src/Library/BotHandlers'. Se sigue el orden establecido en la variable <code>firstHandler</code>. Cada Handler del bot hereda de <code><a class="el" href="classBaseHandler.html" title="Clase base para implementar el patrón Chain of Responsibility. En ese patrón se pasa un mensaje a tra...">BaseHandler</a></code> y recibe como parámetro en su constructor el "siguiente Handler". El funcionamiento es tal que el primer Handler intentará gestionar qué hacer con el mensaje recibido del usuario (evaluado en su método CanHandle()), si no puede gestionarlo va a pasarselo al <code><a class="el" href="interfaceIHandler.html" title="Interfaz para implementar el patrón Chain of Responsibility. En ese patrón se pasa un mensaje a travé...">IHandler</a></code> que le pasamos como parámetro en su constructor. Seguirá esta cadena hasta que uno de los Handlers pueda gestionar el mensaje o se llegue al último (el cual tendrá como siguiente Handler <code>null</code>).</li>
<li><b>Singleton</b>: Utilizamos el patrón Singleton en todas las clases de las que solo queríamos que hubiera una instancia. Esto es importante para las que denominamos "Handler" dentro de 'src/Library' (no confundir con los Handlers mencionados en Chain of Responsibility), ya que estas clases son nuestra "base de datos" junto con las denominadas "catalog" y no nos convenía tener más de una instancia de cada clase ya que no sabríamos a cual acceder para ver y modificar los datos.</li>
<li><b>DIP y LSP</b>: Utilizamos varias veces el principio de inversión de dependencias (DIP) y el LSP, más que nada este último creando varias interfaces, algunas de las cuales utilizan el tipo genérico, para que el programa fuera más expansible. De esta forma, podemos utilizar esas interfaces como intermedio en los métodos, para poder aceptar una variable de cualquier tipo siempre y cuando ese tipo implemente una interfaz específica que le fuerce a poder realizar las acciones que necesitamos.</li>
<li><b>Creator</b>: Respetamos el patrón creator creando instancias de las clases dentro del código de las clases con las que estuvieran más relacionadas. Por ejemplo, la clase encargada de crear una OfertaDeServicio es la clase OfertasHandler ya que es la que interactúa con el usuario y verifica que la información ingresada sea la correcta.</li>
<li><b>Expert y SRP</b>: Nos aseguramos de que nuestras clases cumplieran los principios Expert y SRP siendo expertas en la información que necesitan para cumplir con su única responsabilidad.</li>
</ul>
<p >Nos pareció crucial el uso de patrones y principios para crear un código más reutilizable y en general más entendible. Por ejemplo, si no fuera por el uso de interfaces se nos habría hecho muy dificil integrar y agrupar nuevas clases que realizaran tareas similares. Lo mismo con el singleton como mencionamos, que tener varias instancias de nuestras clases "bases de datos" sería contraproducente en varios sentidos.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md3"></a>
Otras decisiones tomadas:</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
Registro:</h2>
<p >Utilizamos un sistema de registro e inicio de sesión en nuestro bot a pesar de que no era un requerimiento considerando el uso de Telegram, el cual ya tiene un registro propio que podríamos haber empleado. Nuestra decisión se basó en el hecho de que sería molesto, tanto para el testeo como para el uso general del programa, el tener un usuario ligado a una cuenta de Telegram. Por ejemplo, para testear una interacción entre un empleador y trabajador tendríamos que utilizar dos dispositivos con cuentas distintas para generar esa interacción. Utilizando nuestra implementación una misma cuenta de Telegram puede registrar más de un usuario y, uno a la vez, iniciar sesión con ellos. De esta forma, alguien puede pedirle prestado su dispositivo a otra persona y simplemente iniciar sesión con su cuenta, o tener una cuenta como empleador y otra como trabajador, o incluso en el caso de los administradores estos pueden tener su cuenta de administrador y además una cuenta normal como trabajador o empleador.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
API de Ubicación:</h2>
<p >Utilizamos la API DistanceMatrix de Google Maps ya que fue la que encontramos tiempo antes de que nos fuera presentada la recomendada por la Universidad. Esta API requiere el uso de Google Cloud por lo que su uso está limitado a la cantidad de datos que nos permite este servicio por mes. Para este proyecto creemos que esto es más que suficiente y nos da unas herramientas bastante útiles para calcular la distancia entre dos puntos a un nivel bastante preciso y confiable.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Administrador:</h2>
<p >Los administradores los hicimos hardcodeados, enlazados a un ID de Telegram en concreto. Esto fue porque creemos que a una escala reducida no hay necesidad de que haya una gran cantidad de administradores, por lo cual es bastante realista que la persona u organización que utilice el bot se pueda dar a la tarea a añadir manualmente a cada administrador. Sin embargo, para agregar seguridad el administrador va a estar ligado a un ID de Telegram, por lo cual en este caso el administrador solo podrá iniciar sesión utilizando su propia cuenta de Telegram autorizada.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Updater:</h2>
<p >Para poder gestionar los tiempos requeridos por el programa (por ejemplo, que cuando un usuario califique a otro habrá un plazo de un mes para que el usuario calificado haga lo mismo), creamos una clase estática Updater. Esta clase se encarga de periódicamente "avisarle" a todas las clases que requieran llevar una cuenta del tiempo (IActualizables) la fecha actual. Updater tiene un método asíncrono para iniciar actualizaciones automáticas cada X cantidad de tiempo establecida como variable de tipo TimeSpan dentro de la clase; esto inicia timers con esa cantidad de tiempo que, cuando finalizada, le pasa a todos los IActualizable la fecha actual dada por DateTime.Now de forma que estos realicen sus tareas acorde a la fecha. El punto es tener una sola clase con un método asíncrono que se encargue actualizar a las otras, para para que estas otras no tengan que tener, por ejemplo, un timer que cuente 30 días (el cual se detendría si se detiene el programa). Con un solo timer periódico que solo actualice la fecha, y una comparación en las clases actualizables de si ya llegó la fecha que están esperando, nos ahorramos estos problemas.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Panel de Control:</h2>
<p >Separamos las acciones que puede realizar el administrador en un Handler de Telegram exclusivo para este, al cual solo puede entrar un administrador con un ID de Telegram autorizado, y en el cual podrá ver la información de todos los usuarios y todos los datos de ofertas, categorías y solicitudes existentes para poder darlos de baja si es necesario. De esta forma el resto de usuarios tendrán sus métodos que mostrarán solo la información pertinente a ellos y sin este control exclusivo de los administradores.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Singleton Wipes:</h2>
<p >Ya que implementamos el patrón Singleton en varias de nuestras clases, esto causó problemas inesperados a la hora de testear, ya que dentro de un mismo archivo de Test se mantenía la instancia a través de cada test individual, lo cual no queremos que pase si deseamos que cada Test esté aislado como situaciones distintas. Para esto implementamos un método Wipe() en cada Singleton que actúa como un "anti-singleton" y se encarga de borrar la instancia para poder crear una nueva en blanco la próxima vez que se llame al método de GetInstance(), efectivamente rompiendo el Singleton. Es por esto que este método solo lo puede utilizar un administrador que tenga acceso directo al programa, ya que se debería utilizar únicamente en casos de prueba para no romper con el patrón. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
